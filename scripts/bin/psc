#!/bin/bash

function help() {
    echo "Usage: psc <command>"
    echo "This is a alias for the './scripts/' command"
}

command=$1

if [ -z $command ]; then
    echo "No command provided"
    help
    exit 1
fi

if [ $command == "init" ] || [ $command == "i" ]; then
    mkdir -p .scripts
    echo "Directory '.scripts' created"
    exit 0
elif [ $command == "help" ] || [ $command == "h" ]; then
    help
    exit 0
fi

dir=".scripts"
if [ ! -d $dir ]; then
    dir=".script"
fi
if [ ! -d $dir ]; then
    dir="scripts"
fi
if [ ! -d $dir ]; then
    dir="script"
fi
if [ ! -d $dir ]; then
    echo "Directory '.scripts' not found"
    echo "Run 'psc init' to create the directory"
    exit 1
fi

if [ $command == "list" ] || [ $command == "l" ]; then
    echo "Available scripts:"
    ls $dir
    exit 0
fi

if [ $command == "add" ] || [ $command == "a" ]; then
    name=$2
    if [ -z $name ]; then
        echo "No name provided"
        help
        exit 1
    fi
    file="$dir/$name.sh"
    if [ -f $file ]; then
        echo "File already exists"
        exit 1
    fi

    echo "#!/bin/bash" > $file
    echo "" >> $file
    echo "echo \"Running $name\"" >> $file
    chmod +x $file
    echo "File created: $file"
    exit 0
fi



file="$dir/$*"

if [ ! -f $file ]; then
    file="$dir/$*.sh"
fi

if [ -f $file ]; then
    echo "Running $file"
    bash $file
else
    echo "File not found"
fi
